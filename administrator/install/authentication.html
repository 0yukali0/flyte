

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Authentication &mdash; Flyte 0.8.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contributor Docs" href="../../contributor/index.html" />
    <link rel="prev" title="FlyteAdmin Configuration" href="configure/admin.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/flyte_lockup_on_dark.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Flyte Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User docs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administrator Docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Installing Flyte</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="production.html">Handling Production Load</a></li>
<li class="toctree-l3"><a class="reference internal" href="multi_cluster.html">Scaling Beyond Kubernetes</a></li>
<li class="toctree-l3"><a class="reference internal" href="optional_components.html">Optional Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="optional_components.html#data-catalog">Data Catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="managing_customizable_resources.html">Configuring customizable resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="configure/index.html">Configure Flyte backend</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#components">Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#swimlane-diagrams">Swimlane Diagrams</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ci">CI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor/index.html">Contributor Docs</a></li>
</ul>
<p class="caption"><span class="caption-text">Flyte User cookbook and examples (Github)</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lyft/flytesnacks/blob/master/README.md">FlyteSnacks - Examples &amp; Cookbook</a></li>
</ul>
<p class="caption"><span class="caption-text">Generated Documentation from Source</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../flyteidl/index.html">Flyte Language and API specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../flytekit/index.html">Flytekit</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/flytepropeller">FlytePropeller</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/flyteadmin">FlyteAdmin</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/flyteplugins">FlytePlugins</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/datacatalog">DataCatalog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Flyte</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator Docs</a> &raquo;</li>
        
          <li><a href="index.html">Installing Flyte</a> &raquo;</li>
        
      <li>Authentication</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/administrator/install/authentication.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="authentication">
<span id="install-authentication"></span><h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h1>
<p>Flyte Admin ships with a canonical implementation of OAuth2, integrating seamlessly into an organization’s existing identity provider.  At Lyft, we use Okta as the IDP, but if you have issues integrating with another implementation of the OAuth server, please open an issue.</p>
<div class="section" id="components">
<h2>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h2>
<p>While the most obvious interaction with the Flyte control plane is through the web based UI, there are other critical components of Flyte that also need to be considered. These components should be thought of as third-party services even though the Flyte codebase provides them.</p>
<div class="section" id="flyte-cli">
<h3>Flyte CLI<a class="headerlink" href="#flyte-cli" title="Permalink to this headline">¶</a></h3>
<p>Principal amongst these is the Flyte CLI. This is the command-line entrypoint to Flyte Admin and is used by both administrators and users more comfortable in the command line, or are running in a headless OS.</p>
<p>The IDP application corresponding to the CLI will need to support PKCE.</p>
</div>
<div class="section" id="direct-client-access">
<h3>Direct Client Access<a class="headerlink" href="#direct-client-access" title="Permalink to this headline">¶</a></h3>
<p>The gRPC client provided by the Flyte IDL, or direct calls to the HTTP endpoints on Admin from within a running script are ways that we have seen users hit the control plane directly.  We generally discourage this behavior as it leads to a possible self-imposed DOS vector, as they are generally made from within a running workflow itself. For instance, a Flyte task can fetch the definition for a launch plan associated with a completely different workflow, and then launch an execution of it. This is not the correct way to launch one workflow from another but for the time being remains possible.</p>
</div>
</div>
<div class="section" id="swimlane-diagrams">
<h2>Swimlane Diagrams<a class="headerlink" href="#swimlane-diagrams" title="Permalink to this headline">¶</a></h2>
<p>Flyte Admin authentication is implemented using the authorization code flow.</p>
<div class="section" id="flyte-ui-flow">
<h3>Flyte UI Flow<a class="headerlink" href="#flyte-ui-flow" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://swimlanes.io/d/OmV4ybCkx">https://swimlanes.io/d/OmV4ybCkx</a></p>
<a class="reference internal image-reference" href="../../_images/flyte_ui_flow.png"><img alt="Flyte UI Swimlane" src="../../_images/flyte_ui_flow.png" style="width: 600px;" /></a>
</div>
<div class="section" id="flyte-cli-flow">
<h3>Flyte CLI Flow<a class="headerlink" href="#flyte-cli-flow" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://swimlanes.io/d/q64OxuoxT">https://swimlanes.io/d/q64OxuoxT</a></p>
<a class="reference internal image-reference" href="../../_images/flyte_cli_flow.png"><img alt="Flyte CLI Swimlane" src="../../_images/flyte_cli_flow.png" style="width: 600px;" /></a>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="idp-configuration">
<h3>IDP Configuration<a class="headerlink" href="#idp-configuration" title="Permalink to this headline">¶</a></h3>
<p>Flyte Admin will require that the application in your identity provider be configured without PKCE and with a client secret. It should also be configured with a refresh token.</p>
</div>
<div class="section" id="flyte-admin-configuration">
<h3>Flyte Admin Configuration<a class="headerlink" href="#flyte-admin-configuration" title="Permalink to this headline">¶</a></h3>
<p>Please refer to the <a class="reference external" href="https://github.com/lyft/flyteadmin/blob/eaca2fb0e6018a2e261e9e2da8998906477cadb5/pkg/auth/config/config.go">inline documentation</a> on the <code class="docutils literal notranslate"><span class="pre">Config</span></code> object in the <code class="docutils literal notranslate"><span class="pre">auth</span></code> package for a discussion on the settings required.</p>
</div>
</div>
<div class="section" id="ci">
<h2>CI<a class="headerlink" href="#ci" title="Permalink to this headline">¶</a></h2>
<p>If your organization does any automated registration, then you’ll need to authenticate with the <a class="reference external" href="https://tools.ietf.org/html/rfc2617">basic authentication</a> flow (username and password effectively) as CI systems are generally not suitable OAuth resource owners. After retrieving an access token from the IDP, you can send it along to Flyte Admin as usual.</p>
<p>Flytekit configuration variables are automatically designed to look up values from relevant environment variables. To aid with continuous integration use-cases however, Flytekit configuration can also reference other environment variables.  For instance, if your CI system is not capable of setting custom environment variables like <code class="docutils literal notranslate"><span class="pre">FLYTE_CREDENTIALS_CLIENT_SECRET</span></code> but does set the necessary settings under a different variable, you may use <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">FLYTE_CREDENTIALS_CLIENT_SECRET_FROM_ENV_VAR=OTHER_ENV_VARIABLE</span></code> to redirect the lookup. A <code class="docutils literal notranslate"><span class="pre">FLYTE_CREDENTIALS_CLIENT_SECRET_FROM_FILE</span></code> redirect is available as well, where the value should be the full path to the file containing the value for the configuration setting, in this case, the client secret. We found this redirect behavior necessary when setting up registration within our own CI pipelines.</p>
<p>The following is a listing of the Flytekit configuration values we set in CI, along with a brief explanation where relevant.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FLYTE_CREDENTIALS_CLIENT_ID</span></code> and <code class="docutils literal notranslate"><span class="pre">FLYTE_CREDENTIALS_CLIENT_SECRET</span></code>
When using basic authentication, this is the username and password</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">FLYTE_CREDENTIALS_AUTH_MODE=basic</span></code>
This tells the SDK to use basic authentication. If not set, Flytekit will assume you want to use the standard OAuth based three-legged flow.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">FLYTE_CREDENTIALS_AUTHORIZATION_METADATA_KEY=text</span></code>
At Lyft, we set this to conform to this <a class="reference external" href="https://github.com/lyft/flyteadmin/blob/eaca2fb0e6018a2e261e9e2da8998906477cadb5/pkg/auth/config/config.go#L53">header config</a> on the Admin side.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">FLYTE_CREDENTIALS_SCOPE=text</span></code>
When using basic authentication, you’ll need to specify a scope to the IDP (instead of <code class="docutils literal notranslate"><span class="pre">openid</span></code>, as that’s only for OAuth). Set that here.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">FLYTE_PLATFORM_AUTH=True</span></code>
Set this to force Flytekit to use authentication, even if not required by Admin. This is useful as you’re rolling out the requirement.</p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rfcs">
<h3>RFCs<a class="headerlink" href="#rfcs" title="Permalink to this headline">¶</a></h3>
<p>This collection of RFCs may be helpful to those who wish to investigate the implementation in more depth.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc6749">OAuth2 RFC 6749</a></p></li>
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc8414">OAuth Discovery RFC 8414</a></p></li>
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc7636">PKCE RFC 7636</a></p></li>
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc7519">JWT RFC 7519</a></p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../contributor/index.html" class="btn btn-neutral float-right" title="Contributor Docs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configure/admin.html" class="btn btn-neutral float-left" title="FlyteAdmin Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Flyte Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>