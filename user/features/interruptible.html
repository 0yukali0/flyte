

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Interruptible &mdash; Flyte 0.8.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Flyte Task Types" href="../tasktypes/index.html" />
    <link rel="prev" title="On Failure Policy" href="on_failure_policy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/flyte_lockup_on_dark.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Flyte Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html">Flyte Concepts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Flyte Features</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="flytecli.html">Flyte CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="observability.html">Metrics for your executions</a></li>
<li class="toctree-l3"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="labels_annotations.html">Labels and Annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_cache.html">Task Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="roles.html">Why roles?</a></li>
<li class="toctree-l3"><a class="reference internal" href="single_task_execution.html">Single Task Excution</a></li>
<li class="toctree-l3"><a class="reference internal" href="on_failure_policy.html">On Failure Policy</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Interruptible</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-interruptible">What is interruptible?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-are-spot-instances">What are Spot Instances?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-interruptible">Setting Interruptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-tasks-should-be-set-to-interruptible">What tasks should be set to interruptible?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tasktypes/index.html">Flyte Task Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../administrator/index.html">Administrator Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor/index.html">Contributor Docs</a></li>
</ul>
<p class="caption"><span class="caption-text">Flyte User cookbook and examples (Github)</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lyft/flytesnacks/blob/master/README.md">FlyteSnacks - Examples &amp; Cookbook</a></li>
</ul>
<p class="caption"><span class="caption-text">Generated Documentation from Source</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../flyteidl/index.html">Flyte Language and API specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../flytekit/index.html">Flytekit</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/flytepropeller">FlytePropeller</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/flyteadmin">FlyteAdmin</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/flyteplugins">FlytePlugins</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pkg.go.dev/mod/github.com/lyft/datacatalog">DataCatalog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Flyte</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User docs</a> &raquo;</li>
        
          <li><a href="index.html">Flyte Features</a> &raquo;</li>
        
      <li>Interruptible</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/user/features/interruptible.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="interruptible">
<h1>Interruptible<a class="headerlink" href="#interruptible" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-interruptible">
<h2>What is interruptible?<a class="headerlink" href="#what-is-interruptible" title="Permalink to this headline">¶</a></h2>
<p>Interruptible allows users to specify that their tasks are ok to be scheduled on machines that may get preempted such as AWS spot instances.
<a class="reference external" href="https://aws.amazon.com/ec2/spot/?cards.sort-by=item.additionalFields.startDateTime&amp;cards.sort-order=asc">Spot instances</a> can lead up to 90% savings over on-demand. Anyone looking to realize cost savings should look into interruptible.</p>
</div>
<div class="section" id="what-are-spot-instances">
<h2>What are Spot Instances?<a class="headerlink" href="#what-are-spot-instances" title="Permalink to this headline">¶</a></h2>
<p>Spot Instances are unused EC2 capacity in AWS. Spot instances are available at up to a 90% discount compared to on-demand prices. The caveat is that at any point these instances can be preempted and no longer be available for use. This can happen due to:</p>
<ul class="simple">
<li><p>Price – The Spot price is greater than your maximum price.</p></li>
<li><p>Capacity – If there are not enough unused EC2 instances to meet the demand for Spot Instances, Amazon EC2 interrupts Spot Instances. The order in which the instances are interrupted is determined by Amazon EC2.</p></li>
<li><p>Constraints – If your request includes a constraint such as a launch group or an Availability Zone group, these Spot Instances are terminated as a group when the constraint can no longer be met.</p></li>
</ul>
<p>As a general rule of thumb, most spot instances are obtained for around 2 hours (median), with the floor being around 20 minutes, and the ceiling being unbounded duration.</p>
</div>
<div class="section" id="setting-interruptible">
<h2>Setting Interruptible<a class="headerlink" href="#setting-interruptible" title="Permalink to this headline">¶</a></h2>
<p>In order to run your workload on spot, you can set interruptible to True. Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@inputs</span><span class="p">(</span><span class="n">value_to_print</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">)</span>
<span class="nd">@outputs</span><span class="p">(</span><span class="n">out</span><span class="o">=</span><span class="n">Types</span><span class="o">.</span><span class="n">Integer</span><span class="p">)</span>
<span class="nd">@python_task</span><span class="p">(</span><span class="n">cache_version</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">interruptible</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">add_one_and_print</span><span class="p">(</span><span class="n">workflow_parameters</span><span class="p">,</span> <span class="n">value_to_print</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
    <span class="n">workflow_parameters</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s2">&quot;task_run&quot;</span><span class="p">)</span>
    <span class="n">added</span> <span class="o">=</span> <span class="n">value_to_print</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;My printed value: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">added</span><span class="p">))</span>
    <span class="n">out</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">added</span><span class="p">)</span>
</pre></div>
</div>
<p>By setting this value, Flyte will schedule your task on an ASG with only spot instances. In the case your task gets preempted, Flyte will retry your task on a non-spot instance. This retry will not count towards a retry that a user sets.</p>
</div>
<div class="section" id="what-tasks-should-be-set-to-interruptible">
<h2>What tasks should be set to interruptible?<a class="headerlink" href="#what-tasks-should-be-set-to-interruptible" title="Permalink to this headline">¶</a></h2>
<p>Most Flyte workloads should be good candidates for spot instances. If your task does not exhibit the following properties, then the recommendation would be to set interruptible to true.</p>
<ul class="simple">
<li><p>Time sensitive. I need this to run now and can not have any unexpected delays.</p></li>
<li><p>Side Effects. My task is not idempotent and retrying will cause issues.</p></li>
<li><p>Long Running Task. My task takes  &gt; 2 hours. Having an interruption during this time frame could potentially waste a lot of computation already done.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tasktypes/index.html" class="btn btn-neutral float-right" title="Flyte Task Types" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="on_failure_policy.html" class="btn btn-neutral float-left" title="On Failure Policy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Flyte Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>